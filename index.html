<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>SPARKJS</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/animate.css/4.1.0/animate.min.css" rel="stylesheet">
</head>
<body>
<script src="./spark.js"></script>
<script>
    /**
     * 待添加功能 :热更新/数据模块
     */
	var SparkApp = new Spark({});

      
      console.log(SparkApp)

     var title1 =  SparkApp.Text('元素操作：',{
        child:[activeText=SparkApp.Text('READY....',{
         style:'color:red;',
         watch:{
                  text(ov,nv){
                    console.log('ov:'+ov,'nv:'+nv)
                  }
         } 
         })],
        tag:'h1',style:'width:90%;margin:0 auto;'}); 
     
     var boxComCss = SparkApp.Css('position:absolute;width:50%;height:100%;text-align:left;padding:5px;background:#666;z-index:0;top:0;');
     var useCode = SparkApp.Text('READY....',{
          tag:'pre',
          className:boxComCss,
          style:'left:0;'
         
     })

     var node1 = SparkApp.Box({
			style:'min-width:20px;height:20px;background:red;display:inline-block;margin:2px;color:#fff;padding:0 5px;line-height:20px;overflow:hidden;',
			on:{
				click:function(){
                    this.prepend(SparkApp.Text('node1'))
			
				}
			}
		})
	var img1 = SparkApp.Image('https://dgss0.bdstatic.com/5bVWsj_p_tVS5dKfpU_Y_D3/res/r/image/2020-09-07/e699ddddc7d501918ec8b7639496d1d6.png',{style:'width:100px;'});
     var targetContainer = SparkApp.Box({
         className:boxComCss,
         style:'right:0;',
         child:[node1,img1]
     })
     
     var bthcss = SparkApp.Css('position:absolute;bottom:2px;background-color:#ccc;color:#fff;padding:10px;')
     var wrapcss=SparkApp.Css('width:90%;height:300px;margin:20px auto;border:1px dashed #fff; border-radius:5px;position:relative;text-align:center;');
    
     var btnAdd1 = SparkApp.Box({
     	tag:'button',
     	style:'background-color:green;left:2px;',
     	className:bthcss,
     	child:[SparkApp.Text('ADD append')],
     	on:{
     		click:function(_this){
                 activeText.text='append';
                 useCode.text='后置追加元素：\n\n方法1:targetContainer.append([node1,node1]);\n方法2：SparkApp.append(targetContainer,[node1,node1]);';
                 targetContainer.append([node1,node1],{ani:'slideInRight 500ms both'});  

               
     		}
     	}
     })

      var btnAdd2 = SparkApp.Box({
        tag:'button',
        style:'background-color:green;left:2px;bottom:45px;',
        className:bthcss,
        child:[SparkApp.Text('ADD prepend')],
        on:{
            click:function(_this){
                 activeText.text='prepend';
                 useCode.text='前置添加元素：\n\n方法1:targetContainer.prepend(node2);\n方法2：SparkApp.prepend(targetContainer,node2);';
                 targetContainer.prepend(SparkApp.Box({
                                            style:'min-width:20px;height:20px;background:yellow;display:inline-block;margin:2px;color:blue;padding:0 5px;line-height:20px;overflow:hidden;animation: bounceInLeft 0.5s both;',
                                            on:{
                                                click:function(){
                                                  this.prepend(SparkApp.Text('node2'))
                                                }
                                            }
                                        })
                 );  
             
                
            }
        }
     })
      
      /*after()*/
       var btnAfter = SparkApp.Box({
     	tag:'button',
     	style:'background-color:green;left:100px;',
     	className:bthcss,
     	child:[SparkApp.Text('ADD after')],
     	on:{
     		click:function(_this){
                 img1.after([SparkApp.Box({
                                            style:'min-width:20px;height:20px;background:pink;display:inline-block;margin:2px;color:blue;padding:0 5px;line-height:20px;overflow:hidden;animation: bounceInLeft 0.5s both;',
                                            on:{
                                                click:function(){
                                                  this.prepend(SparkApp.Text('node3'))
                                                }
                                            }
                                        })],
                 {ani:'zoomIn 500ms both'});  
     		 }
     	  }
       })
       /*before()*/
       var btnBefore = SparkApp.Box({
     	tag:'button',
     	style:'background-color:green;left:100px;bottom:45px;',
     	className:bthcss,
     	child:[SparkApp.Text('ADD before')],
     	on:{
     		click:function(_this){
                 img1.before([node1,node1],{ani:'slideInLeft 500ms both'});  
     		 }
     	  }
       })


      var btnDel1 = SparkApp.Box({
     	tag:'button',
     	style:'background-color:#666;right:2px;',
     	className:bthcss,
     	child:[SparkApp.Text('DEL Target node')],
     	on:{
     		click:function(_this){
                  
                   activeText.text='remove widget';
                   useCode.text='删除指定元素：\n\n方法1:node1.remove();\n方法2：SparkApp.remove(targetContainer,node1);';
                   // node1.style='animation: bounceOut 500ms both';
                   node1.remove({ani:'bounceOut 500ms both',time:500});

     		}
          }
     })

      var btnDel2 = SparkApp.Box({
        tag:'button',
        style:'background-color:#666;right:2px;bottom:45px;',
        className:bthcss,
        child:[SparkApp.Text('DEL index=0')],
        on:{
            click:function(_this){
                    activeText.text='remove WidgetIndex';
                    useCode.text="删除索引元素：\n\n方式1：targetContainer.remove(<Widget> | <Index> |<firstChild,lastChild>)\n\n方式2：\n删除指定索引：SparkApp.remove(targetContainer,2);\n删除第一个:SparkApp.remove(targetContainer,'firstChild')\n删除最后一个：SparkApp.remove(targetContainer,'lastChild');";
                
                     targetContainer.removeChild(0,{ani:'bounceOut 500ms both',time:500})
                  

            }
          }
     })
   


     

   var  wrap = SparkApp.Box({
        className:wrapcss,
        style:'overflow:hidden;',
        child:[useCode,targetContainer,btnAdd1,btnAdd2,btnAfter,btnBefore,btnDel1,btnDel2],
        watch:{
            child:function(o,n){
             console.log('update')
            }
        }
    })
 
    var title2 =  SparkApp.Text('列表渲染：',{
        tag:'h1',style:'width:90%;margin:0 auto;'}); 
    
    var listStyle = SparkApp.Css('margin:5px;padding:5px;background-color:#666;animation: fadeInLeft 500ms both;');
    
  
    var  List = SparkApp.List({
          data:[{a:'item',b:'hello world'},{a:'item',b:'hello spark'},{a:'item',b:'hello CS'}],
          style:'width:100%;height:100%;margin:0px auto;padding:5px;overflow:auto;',
          watch:{
            data(o,a){
               console.log(o,a)
            },
          },
          item(item,index){
            return SparkApp.Box({
                tag:'li',
                style:'margin:5px;padding:5px;background-color:#666;',
                className:listStyle,
                child:[SparkApp.Text(item.a+index+'---'),SparkApp.Text(item.b),
                ],
                init(){

                    if(index== 1){
                        this.style='background-color:red;'
                        // console.log( this.data())
                    }
                },
                on:{
                    click(){
                     
                        listStyle.style='background-color:#666;'
                        this.style='background-color:red;'

                        console.log(item)
                    }
                }

            })
          }

     })

     var  wrap2 = SparkApp.Box({
           className:wrapcss,  
           child:[List,
                SparkApp.Text('添加数据1',{
                    tag:'button',
                    className:bthcss,
                    style:'background-color:green;left:2px;bottom:0;',
                    on:{
                        click(){
                            List.push({a:'item',b:'hello spark2'})
                            // console.log(List)
                        }
                    }
                  }),
                    SparkApp.Text('添加数据2',{
                        tag:'button',
                        className:bthcss,
                        style:'background-color:green;left:2px;bottom:45px;',
                        on:{
                            click(){
                             List.unshift({a:'item',b:'hello spark2'})
                                // console.log(List)
                            }
                        }
                      }),
                   ]
       });


     SparkApp.Page({
     	style:'width:100%;min-height:100vh;background-color:#272822;overflow:auto;padding:20px 0; padding-bottom:50px;color:#fff;',
     	child:[title1,wrap,title2,wrap2]
     })
</script>	
</body>
</html>